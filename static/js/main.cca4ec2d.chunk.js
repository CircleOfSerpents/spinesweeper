(this.webpackJsonpspinesweeper=this.webpackJsonpspinesweeper||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var i,l=n(0),c=n.n(l),s=n(26),o=n.n(s),r=n(30),a=n(1),u=(n(36),n(10)),d=(n(37),n(3)),h=n(4),g=n(24);!function(e){e[e.Unclicked=0]="Unclicked",e[e.Clicked=1]="Clicked",e[e.Flagged=2]="Flagged",e[e.Questioned=3]="Questioned",e[e.UnclickedMine=4]="UnclickedMine",e[e.ClickedMine=5]="ClickedMine",e[e.FlaggedMine=6]="FlaggedMine",e[e.QuestionedMine=7]="QuestionedMine",e[e.Invalid=8]="Invalid"}(i||(i={}));i.Unclicked,i.Clicked,i.Flagged,i.Questioned;var f,m=[i.UnclickedMine,i.ClickedMine,i.FlaggedMine,i.QuestionedMine],v=[i.Unclicked,i.UnclickedMine,i.Flagged,i.FlaggedMine,i.Questioned,i.QuestionedMine],b=[i.Flagged,i.FlaggedMine],k=[i.Unclicked,i.Flagged,i.Questioned],C=(i.Clicked,i.ClickedMine,function(){function e(){Object(d.a)(this,e),this._isClicked=!1,this._isMine=!1,this._isFlagged=!1,this._isQuestioned=!1}return Object(h.a)(e,[{key:"cellState",get:function(){return this._isClicked?this._isMine?i.ClickedMine:i.Clicked:this._isMine?this._isFlagged?i.FlaggedMine:this._isQuestioned?i.QuestionedMine:i.UnclickedMine:this._isFlagged?i.Flagged:this._isQuestioned?i.Questioned:i.Unclicked}},{key:"click",value:function(){this._isFlagged||this._isQuestioned||(this._isClicked=!0)}},{key:"rightClick",value:function(){this._isClicked||(this._isFlagged?(this._isFlagged=!1,this._isQuestioned=!0):this._isQuestioned?this._isQuestioned=!1:this._isFlagged=!0)}},{key:"isMine",set:function(e){this._isMine=e}}]),e}());!function(e){e[e.Idle=0]="Idle",e[e.Active=1]="Active",e[e.Won=2]="Won",e[e.Lost=3]="Lost"}(f||(f={}));var j=[{row:0,column:1},{row:1,column:0},{row:0,column:-1},{row:-1,column:0},{row:1,column:1},{row:-1,column:-1},{row:1,column:-1},{row:-1,column:1}],w=function(){function e(t,n,i){Object(d.a)(this,e),this.rows=void 0,this.columns=void 0,this.mines=void 0,this.mineCount=void 0,this.board=void 0,this.validateInputs(t,n,i),this.rows=t,this.columns=n,this.mines=0,this.board=this.createInternalBoard(i),this.addMines(i),this.mineCount=this.mines}return Object(h.a)(e,[{key:"click",value:function(e){var t=this.getCellState(e);t===i.Unclicked?this.floodfill(e):t===i.UnclickedMine?this.explode():this.isFullyFlaggedCell(e)&&this.clickAllNeighbors(e),this.mineCount=this.calculateMineCount();var n=this.calculateGameState();return this.cleanUpGameIfNecessary(n),n}},{key:"rightClick",value:function(e){var t=this.getCell(e);v.includes(t.cellState)?t.rightClick():this.isFullyFlaggedCell(e)&&this.clickAllNeighbors(e),this.mineCount=this.calculateMineCount();var n=this.calculateGameState();return this.cleanUpGameIfNecessary(n),n}},{key:"calculateGameState",value:function(){var e=this.getStateCounts();return e[i.ClickedMine]?f.Lost:(e[i.Unclicked]||0)+(e[i.Flagged]||0)+(e[i.Questioned]||0)===0?f.Won:f.Active}},{key:"calculateMineCount",value:function(){for(var e=this.mines,t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)b.includes(this.getCellState({row:t,column:n}))&&(e-=1);return e}},{key:"getStateCounts",value:function(){for(var e={},t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++){var i=this.getCellState({row:t,column:n});e[i]=(e[i]||0)+1}return e}},{key:"clickAllNeighbors",value:function(e){var t=this;this.getInBoundNeighbors(e).forEach((function(e){t.getCellState(e)===i.UnclickedMine?t.explode():t.floodfill(e)}))}},{key:"getCellNumNeighborMines",value:function(e){var t=this;return this.isCellInBounds(e)?this.getInBoundNeighbors(e).map((function(e){return t.isMineCell(e)})).filter(Boolean).length:0}},{key:"getCellNumNeighborFlags",value:function(e){var t=this;return this.isCellInBounds(e)?this.getInBoundNeighbors(e).map((function(e){return t.isFlaggedCell(e)})).filter(Boolean).length:0}},{key:"getCell",value:function(e){if(!this.isCellInBounds(e))throw Error("Cell out of bounds");return this.board[e.row][e.column]}},{key:"getCellState",value:function(e){if(!this.isCellInBounds(e))throw Error("Cell out of bounds");return this.board[e.row][e.column].cellState}},{key:"floodfill",value:function(e){var t=this;this.getCellState(e)===i.Unclicked&&(this.getCell(e).click(),0===this.getCellNumNeighborMines(e)&&this.getInBoundNeighbors(e).forEach((function(e){t.floodfill(e)})))}},{key:"explode",value:function(){for(var e=0;e<this.rows;e++)for(var t=0;t<this.columns;t++)this.isMineCell({row:e,column:t})&&this.board[e][t].click()}},{key:"getInBoundNeighbors",value:function(e){var t=this,n=[];return j.forEach((function(i){var l={row:e.row+i.row,column:e.column+i.column};t.isCellInBounds(l)&&n.push(l)})),n}},{key:"isCellInBounds",value:function(e){return!(e.row<0||e.row>=this.rows)&&!(e.column<0||e.column>=this.columns)}},{key:"createInternalBoard",value:function(e){for(var t=Array(this.rows),n=0;n<this.rows;n++){t[n]=Array(this.columns);for(var i=0;i<this.columns;i++)t[n][i]=new C}return t}},{key:"addMines",value:function(e){for(var t=this.rows*this.columns/2,n=0;n<e&&this.mines<t;){var i=this.getRandomInt(this.rows),l=this.getRandomInt(this.columns);this.isUnclickedNonMineCell({row:i,column:l})&&(this.board[i][l].isMine=!0,n++,this.mines++)}}},{key:"isMineCell",value:function(e){return m.includes(this.getCellState(e))}},{key:"isUnclickedNonMineCell",value:function(e){return k.includes(this.getCellState(e))}},{key:"isFlaggedCell",value:function(e){return b.includes(this.getCellState(e))}},{key:"isFullyFlaggedCell",value:function(e){return this.getCellState(e)===i.Clicked&&this.getCellNumNeighborFlags(e)===this.getCellNumNeighborMines(e)}},{key:"cleanUpGameIfNecessary",value:function(e){if(e===f.Won)for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.getCellState({row:t,column:n})===i.QuestionedMine&&this.rightClick({row:t,column:n}),this.getCellState({row:t,column:n})===i.UnclickedMine&&this.rightClick({row:t,column:n})}},{key:"validateInputs",value:function(e,t,n){var i=e*t/2;if(n<0||n>i)throw Error("Please provide a number of mines between 0 and ".concat(i));if(e<=0||e>100)throw Error("Please provide a number of rows between 1 and 100");if(t<=0||t>100)throw Error("Please provide a number of columns between 1 and 100")}},{key:"getRandomInt",value:function(e){var t=Math.floor(Math.random()*e);return t>e?e:t}},{key:"allCells",value:function(){for(var e=[],t=0;t<this.rows;t++)e=e.concat(this.board[t]);return e}}]),e}(),M=function(){function e(t,n,i){Object(d.a)(this,e),this.board=void 0,this._gameState=f.Idle,this.board=new w(t,n,i)}return Object(h.a)(e,[{key:"gameState",get:function(){return this._gameState}},{key:"click",value:function(e){return this._gameState===f.Won||this._gameState===f.Lost?this:(this._gameState=this.board.click(e),g.cloneDeep(this))}},{key:"rightClick",value:function(e){return this._gameState===f.Won||this._gameState===f.Lost?this:(this._gameState=this.board.rightClick(e),g.cloneDeep(this))}}]),e}();n(39),n(40);var O=n(2);var p=function(e){var t=e.cellState,n=e.numNeighborMines;return Object(O.jsx)("div",{className:"GameCell ".concat(v.includes(t)?"unclicked":t===i.Clicked?"clicked":t===i.ClickedMine?"clicked-mine":""),children:t===i.Clicked&&n>0?String(n):t===i.ClickedMine?"\ud83d\udca3":t===i.Flagged||t===i.FlaggedMine?"\ud83d\udea9":t===i.Questioned||t===i.QuestionedMine?"\u2753":""})};var y=function(e){var t=e.gameBoard,n=e.onCellClick;return Object(O.jsx)("div",{className:"GameBoard",id:"game-board","data-testid":"game-board",children:t.board.map((function(e,i){return Object(O.jsx)("div",{className:"Row",children:e.map((function(e,l){return Object(O.jsx)("div",{className:"Cell",onClick:function(e){return n(e,{row:i,column:l})},onContextMenu:function(e){return n(e,{row:i,column:l})},children:Object(O.jsx)(p,{cellState:t.getCellState({row:i,column:l}),numNeighborMines:t.getCellNumNeighborMines({row:i,column:l})})},l)}))},i)}))})};n(42);var S=function(e){var t=e.gameState,n=Object(l.useState)(0),i=Object(u.a)(n,2),c=i[0],s=i[1];return function(e,t,n){var i=Object(l.useRef)(),c=Object(l.useRef)(),s=Object(l.useRef)();function o(){i.current&&i.current()}Object(l.useEffect)((function(){i.current=e,c.current=t})),Object(l.useEffect)((function(){n===f.Active?s.current=setInterval(o,1e3):n!==f.Lost&&n!==f.Won&&n!==f.Idle||void 0===s.current||(clearInterval(s.current),n===f.Idle&&c.current&&c.current(0))}),[n])}((function(){return s(c+1)}),(function(){return s(0)}),t),Object(O.jsx)("div",{children:c})};document.addEventListener("contextmenu",(function(e){e.preventDefault()}));var F=function(){var e=Object(l.useState)(new M(20,20,50)),t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(O.jsx)("div",{className:"App",children:Object(O.jsxs)("header",{className:"App-header",children:[Object(O.jsx)("button",{onClick:function(){i(new M(20,20,50))},children:"Reset"}),Object(O.jsxs)("div",{className:"header-numbers",children:[Object(O.jsx)(S,{gameState:n.gameState}),n.board.mineCount]}),Object(O.jsx)(y,{gameBoard:n.board,onCellClick:function(e,t){if("click"===e.type){var l=n.click(t);i(l)}else if("contextmenu"===e.type){var c=n.rightClick(t);i(c)}}})]})})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,49)).then((function(t){var n=t.getCLS,i=t.getFID,l=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),i(e),l(e),c(e),s(e)}))},x=n(31);n(47);document.addEventListener("contextmenu",(function(e){e.preventDefault()}));var I=function(){var e=Object(l.useRef)();Object(l.useEffect)((function(){e.current=Object(x.a)(),e.current.on("setGame",(function(e){c(function(e){var t=new M(10,10,10);Object.assign(t,e);for(var n=0;n<t.board.rows;n++)for(var i=0;i<t.board.columns;i++){var l=new C;Object.assign(l,e.board.board[n][i]),e.board.board[n][i]=l}return t.board=new w(10,10,10),Object.assign(t.board,e.board),t}(e))}))}),[]);var t=Object(l.useState)(),n=Object(u.a)(t,2),i=n[0],c=n[1];return Object(O.jsx)("div",{className:"App",children:!!i&&Object(O.jsxs)("header",{className:"App-header",children:[Object(O.jsx)("button",{onClick:function(){e.current&&e.current.emit("resetGame")},children:"Reset"}),Object(O.jsxs)("div",{className:"header-numbers",children:[Object(O.jsx)(S,{gameState:i.gameState}),i.board.mineCount]}),Object(O.jsx)(y,{gameBoard:i.board,onCellClick:function(t,n){"click"===t.type?e.current&&e.current.emit("click",n):"contextmenu"===t.type&&e.current&&e.current.emit("rightClick",n)}})]})})};o.a.render(Object(O.jsxs)(c.a.StrictMode,{children:[Object(O.jsx)(r.a,{children:Object(O.jsxs)(a.c,{children:[Object(O.jsx)(a.a,{path:"/",element:Object(O.jsx)(F,{})}),Object(O.jsx)(a.a,{path:"coop",element:Object(O.jsx)(I,{})})]})}),","]}),document.getElementById("root")),N()}},[[48,1,2]]]);
//# sourceMappingURL=main.cca4ec2d.chunk.js.map